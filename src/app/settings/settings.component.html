<!--<p-button label="Raum anzeigen" (click)="this.showAllRooms()" severity="danger"></p-button>-->
<!--<p-button label="Raum hinzufügen" (click)="this.createRoom()" severity="danger"></p-button>-->

<div class="flex gap-2 mt-4 justify-start !mt-2">
  <p-button label="Kurs Hinzufügen" icon="pi pi-plus" (click)="openCourseModal()"></p-button>
</div>

<div class="card !pt-5">
  <p-table
    [columns]="cols"
    [value]="filteredCourses"
    [tableStyle]="{ 'min-width': '50rem' }"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5, 10, 20]"
  >
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th *ngFor="let col of columns">{{ col.header }}</th>
        <th colspan="3">Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr>
        <td *ngFor="let col of columns">{{ rowData[col.field] }}</td>
        <td>
          <p-button label="Invite" (click)="openInviteModal(rowData)"></p-button>
        </td>
        <!--        <td>-->
        <!--          <p-button label="Edit" (click)="openEditModal(rowData)"></p-button>-->
        <!--        </td>-->
        <!--        <td>-->
        <!--          <p-button label="Delete" severity="danger" (click)="openDeleteModal(rowData)"></p-button>-->
        <!--        </td>-->
      </tr>
    </ng-template>
  </p-table>
</div>


<p-dialog header="Kurs hinzufügen" [(visible)]="courseModalVisible" [modal]="true"
          [style]="{ width: '50vw',height:'100vh' }" [dismissableMask]="true">
  <div class="card flex justify-center">
    <p-stepper [(value)]="step1Value">
      <p-step-list>
        <p-step [value]="1">Raum anlegen</p-step>
        <p-step [value]="2">Dateien hochladen</p-step>
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col gap-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="flex flex-col">
                  <label for="name" class="mb-1 font-medium">Name</label>
                  <input id="name" type="text" pInputText [(ngModel)]="newCourse.name" />
                </div>

                <div class="flex flex-col">
                  <label for="year" class="mb-1 font-medium">Jahr</label>
                  <input id="year" type="number" pInputText [(ngModel)]="newCourse.year" />
                </div>

                <div class="flex flex-col">
                  <label for="semester" class="mb-1 font-medium">Semester</label>
                  <input id="semester" type="text" pInputText [(ngModel)]="newCourse.semester" />
                </div>

                <div class="flex flex-col">
                  <label for="icon" class="mb-1 font-medium">Icon</label>
                  <p-select
                    [options]="icons"
                    [(ngModel)]="selectedIcons"
                    optionLabel="name"
                    placeholder="Icon auswählen"
                    class="w-full"
                  >
                    <!-- Selected item -->
                    <ng-template #selectedItem let-selectedOption>
                      <div class="flex items-center gap-2" *ngIf="selectedOption">
                        <img [src]="selectedOption.path" style="width: 18px" alt="icons"/>
                        <div>{{ selectedOption.name }}</div>
                      </div>
                    </ng-template>

                    <!-- Dropdown item -->
                    <ng-template let-icon pTemplate="item">
                      <div class="flex items-center gap-2">
                        <img [src]="icon.path" alt="{{icon.name}}" style="width: 20px; height: 20px;" />
                        <div>{{ icon.name }}</div>
                      </div>
                    </ng-template>
                  </p-select>
                </div>
              </div>
              <p-button
                label="Create Room"
                (onClick)="roomService.createGroup(newCourse.name, newCourse.year, newCourse.semester, selectedIcons!.name)">              </p-button>


              <div class="flex justify-end pt-4">
                <p-button label="Next" (onClick)="activateCallback(2)"></p-button>
              </div>
            </div>
          </ng-template>
        </p-step-panel>
        <p-step-panel [value]="2">
          <ng-template #content>
            <div class="flex flex-col h-auto">
              <div
                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 0 flex-auto flex justify-center items-center font-medium"
              >
                <div class="card">

                  <p-fileupload
                    #uploader
                    name="demo[]"
                    [customUpload]="true"
                    [multiple]="true"
                    accept="image/*,application/pdf"
                    maxFileSize="100000000"
                    mode="advanced"
                    (uploadHandler)="onMockUpload($event, uploader)"
                  >
                    <ng-template pTemplate="empty">
                      <div>Drag and drop files here to mock upload.</div>
                    </ng-template>
                  </p-fileupload>
                </div>

                <!-- Listbox für Dateinamen -->
                <div class="card flex justify-center mt-4">
                  <p-listbox
                    [options]="files()"
                    [(ngModel)]="selectedFile"
                    optionLabel="name"
                    class="w-full md:w-64"
                    (onChange)="onFileSelect($event)"
                  ></p-listbox>
                </div>
              </div>
            </div>
            <div class="flex justify-between pt-4">
              <p-button label="Back" (click)="step1Value = 1"></p-button>
              <p-button label="Kurs hinzufügen" severity="danger" (click)="courseModalVisible = false"></p-button>
            </div>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>
  </div>
</p-dialog>


<!--Avatar-->



<!-- ADD COURSE MODAL -->
<!--<p-dialog header="Kurs hinzufügen" [modal]="true" [(visible)]="addModalVisible" [style]="{ width: 'auto' }"-->
<!--          [closable]="true" [dismissableMask]="true">-->

<!--  <div class="card flex justify-center">-->
<!--    <p-stepper [value]="1" class="">-->
<!--      <p-step-list>-->
<!--        <p-step [value]="1">Raum anlegen</p-step>-->
<!--        <p-step [value]="2">Bild hochladen</p-step>-->
<!--        <p-step [value]="3">Audio aufnehmen</p-step>-->
<!--        <p-step [value]="4">Dateien hochladen</p-step>-->
<!--      </p-step-list>-->
<!--      <p-step-panels>-->
<!--        <p-step-panel [value]="1">-->
<!--          <ng-template #content let-activateCallback="activateCallback">-->
<!--            <div class="flex flex-col h-48">-->
<!--              <div-->
<!--                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50  flex-auto flex justify-center items-center font-medium"-->
<!--              >-->
<!--                <div class="p-fluid">-->
<!--                  <div class="p-field !pb-3">-->
<!--                    <label for="courseID" class="!pr-5">Kurs ID</label>-->
<!--                    <input id="courseID" type="text" pInputText [(ngModel)]="newCourse.courseID"/>-->
<!--                  </div>-->
<!--                  <div class="p-field !pb-5">-->
<!--                    <label for="name" class="!pr-5">Name</label>-->
<!--                    <input id="name" type="text" pInputText [(ngModel)]="newCourse.name"/>-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--              <div class="flex !pt-6 justify-end">-->
<!--                <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(2)"/>-->
<!--              </div>-->
<!--            </div>-->
<!--          </ng-template>-->
<!--        </p-step-panel>-->

<!--        <p-step-panel [value]="2">-->
<!--          <ng-template #content let-activateCallback="activateCallback">-->
<!--            <div class="flex flex-col h-48">-->
<!--              <div-->
<!--                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50  flex-auto flex justify-center items-center font-medium"-->
<!--              >-->
<!--                <div class="card flex justify-center">-->
<!--                  <p-fileupload mode="basic"-->
<!--                                name="demo[]"-->
<!--                                chooseIcon="pi pi-upload"-->
<!--                                accept="image/*"-->
<!--                                maxFileSize="10000000"-->
<!--                                (onSelect)="onImageSelect($event)"-->
<!--                                (onUpload)="onBasicUploadAuto($event)"-->
<!--                                [auto]="true"-->
<!--                                chooseLabel="Browse"-->

<!--                  />-->
<!--                </div>-->
<!--                &lt;!&ndash; Image preview with download on click &ndash;&gt;-->
<!--                <div *ngIf="previewUrl" style="margin-top: 1rem;">-->
<!--                  <a [href]="previewUrl" download="image.png">-->
<!--                    <img-->
<!--                      [src]="previewUrl"-->
<!--                      alt="Uploaded Image"-->
<!--                      style="max-width: 300px; border: 1px solid #ccc; padding: 5px; cursor: pointer;"-->
<!--                    />-->
<!--                  </a>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="flex !pt-6 justify-between">-->
<!--              <p-button label="Back" severity="secondary" icon="pi pi-arrow-left" (onClick)="activateCallback(1)"/>-->
<!--              <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(3)"/>-->
<!--            </div>-->
<!--          </ng-template>-->
<!--        </p-step-panel>-->

<!--        <p-step-panel [value]="3">-->
<!--          <ng-template #content let-activateCallback="activateCallback">-->
<!--            <div class="flex flex-col h-48">-->
<!--              <div-->
<!--                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50  flex-auto flex justify-center items-center font-medium"-->
<!--              >-->
<!--                <div class="audio ">-->

<!--                  <p-button class="!p-3" (click)="startRecording()" label="️Start Aufnahme" severity="primary"-->
<!--                            icon="pi pi-microphone" [disabled]="isRecording"/>-->
<!--                  <p-button class="!p-3" (click)="stopRecording()" label="Stop" severity="primary"-->
<!--                            icon="pi pi-pause-circle" [disabled]="!isRecording"/>-->


<!--                  <div *ngIf="audioUrl" style="margin-top: 1rem;">-->
<!--                    <audio [src]="audioUrl" controls></audio>-->
<!--                  </div>-->

<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="flex !pt-6 justify-between">-->
<!--              <p-button label="Back" severity="secondary" icon="pi pi-arrow-left" (onClick)="activateCallback(2)"/>-->
<!--              <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="activateCallback(4)"/>-->
<!--            </div>-->
<!--          </ng-template>-->
<!--        </p-step-panel>-->

<!--        <p-step-panel [value]="4">-->
<!--          <ng-template #content let-activateCallback="activateCallback">-->
<!--            <div class="flex flex-col h-auto">-->
<!--              <div-->
<!--                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 0 flex-auto flex justify-center items-center font-medium"-->
<!--              >-->
<!--                <div class="card">-->

<!--                  <p-fileupload-->
<!--                    #uploader-->
<!--                    name="demo[]"-->
<!--                    [customUpload]="true"-->
<!--                    [multiple]="true"-->
<!--                    accept="image/*,application/pdf"-->
<!--                    maxFileSize="100000000"-->
<!--                    mode="advanced"-->
<!--                    (uploadHandler)="onMockUpload($event, uploader)"-->
<!--                  >-->
<!--                    <ng-template pTemplate="empty">-->
<!--                      <div>Drag and drop files here to mock upload.</div>-->
<!--                    </ng-template>-->
<!--                  </p-fileupload>-->
<!--                </div>-->

<!--                &lt;!&ndash; Listbox für Dateinamen &ndash;&gt;-->
<!--                <div class="card flex justify-center mt-4">-->
<!--                  <p-listbox-->
<!--                    [options]="files()"-->
<!--                    [(ngModel)]="selectedFile"-->
<!--                    optionLabel="name"-->
<!--                    class="w-full md:w-64"-->
<!--                    (onChange)="onFileSelect($event)"-->
<!--                  ></p-listbox>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="flex !pt-6 justify-start">-->
<!--              <p-button label="Back" icon="pi pi-arrow-left" iconPos="right" (onClick)="activateCallback(3)"/>-->
<!--            </div>-->
<!--            <div class="flex justify-end gap-2 mt-4">-->
<!--              <p-button label="Abbrechen" class="p-button-text" (click)="addModalVisible = false"></p-button>-->
<!--              <p-button label="Kurs hinzufügen" severity="danger" (click)="addCourse()"></p-button>-->
<!--            </div>-->
<!--          </ng-template>-->
<!--        </p-step-panel>-->
<!--      </p-step-panels>-->
<!--    </p-stepper>-->
<!--  </div>-->


<!--</p-dialog>-->


<!-- EDIT COURSE MODAL -->
<!--<p-dialog header="Kurs bearbeiten" [modal]="true" [(visible)]="editModalVisible" [style]="{ width: '30rem' }"-->
<!--          [closable]="true" [dismissableMask]="true">-->
<!--  <div class="p-fluid">-->
<!--    <div class="p-field !pb-3">-->
<!--      <label for="editCourseID" class="!pr-5">Kurs ID</label>-->
<!--      <input id="editCourseID" type="text" pInputText [(ngModel)]="editedCourse.courseID"/>-->
<!--    </div>-->
<!--    <div class="p-field !pb-5">-->
<!--      <label for="editName" class="!pr-5">Name</label>-->
<!--      <input id="editName" type="text" pInputText [(ngModel)]="editedCourse.name"/>-->
<!--    </div>-->
<!--  </div>-->
<!--  <div class="flex justify-end gap-2 mt-4 ">-->
<!--    <p-button label="Abbrechen" class="p-button-text" (click)="editModalVisible = false"></p-button>-->
<!--    <p-button label="Kurs bearbeiten" severity="danger" (click)="updateCourse()"></p-button>-->
<!--  </div>-->
<!--</p-dialog>-->

<!-- DELETE COURSE MODAL -->
<p-dialog header="Kurs löschen" [modal]="true" [(visible)]="deleteModalVisible" [style]="{ width: '50rem' }"
          [closable]="true" [dismissableMask]="true">
  <p>Wollen Sie wirklich den Kurs <b>{{ selectedCourse?.name }}</b> löschen?</p>
  <div class="flex justify-end gap-2 mt-4 !pt-3">
    <p-button label="Abbrechen" class="p-button-text" (click)="deleteModalVisible = false"></p-button>
<!--    <p-button label="Kurs löschen" severity="danger" (click)="deleteCourse()"></p-button>-->
  </div>
</p-dialog>

<!-- Invite  MODAL -->
<p-dialog header="Einladen" [modal]="true" [(visible)]="inviteModalVisible" [style]="{ width: '50rem',height:'50rem' }"
          [closable]="true" [dismissableMask]="true">


  <div class="card">
    <p-table [value]="users" [(selection)]="selectedUser" dataKey="id" [tableStyle]="{'min-width': '50rem'}">
      <ng-template #header>
        <tr>
          <th style="width: 4rem">
            <p-tableHeaderCheckbox/>
          </th>
          <th>Name</th>
          <th>Nachname</th>
          <th>Email</th>
        </tr>
      </ng-template>
      <ng-template #body let-user>
        <tr>
          <td>
            <p-tableCheckbox [value]="user"/>
          </td>
          <td>{{ user.firstName }}</td>
          <td>{{ user.lastName }}</td>
          <td>{{ user.email }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>


  <div class="flex justify-end gap-2 mt-4 !pt-3">
    <p-button label="Abbrechen" class="p-button-text" (click)="inviteModalVisible = false"></p-button>
    <p-button label="User hinzufügen" (click)="addUsersToRoom()" severity="danger"></p-button>
  </div>
</p-dialog>




